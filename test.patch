From c50783610a4792d269ec7ffb74a5723ab3913b30 Mon Sep 17 00:00:00 2001
From: "cazen.lee" <cazen.lee@samsung.com>
Date: Mon, 16 Jan 2017 13:38:50 +0900
Subject: [PATCH] create patch

---
 .../com/cazen/iti/repository/TryQuestionRepository.java |  6 +++++-
 .../java/com/cazen/iti/service/TryQustionService.java   |  8 +++++++-
 .../cazen/iti/service/impl/TryQustionServiceImpl.java   | 17 +++++++++++++++--
 .../com/cazen/iti/web/rest/TryQuestionResource.java     |  7 ++++++-
 4 files changed, 33 insertions(+), 5 deletions(-)

diff --git a/src/main/java/com/cazen/iti/repository/TryQuestionRepository.java b/src/main/java/com/cazen/iti/repository/TryQuestionRepository.java
index c5208b6..5d135cd 100644
--- a/src/main/java/com/cazen/iti/repository/TryQuestionRepository.java
+++ b/src/main/java/com/cazen/iti/repository/TryQuestionRepository.java
@@ -1,6 +1,7 @@
 package com.cazen.iti.repository;

 import com.cazen.iti.domain.CommonCode;
+import com.cazen.iti.domain.QuestionMaster;
 import org.springframework.data.jpa.repository.JpaRepository;
 import org.springframework.data.jpa.repository.Query;

@@ -13,4 +14,7 @@ import java.util.List;
 public interface TryQuestionRepository extends JpaRepository<CommonCode,Long> {
     @Query(value = "SELECT * FROM COMMON_CODE WHERE CD_TP LIKE 'QSTN_SEC%'", nativeQuery = true)
     List<CommonCode> getCategory123CommonCodeList();
-}
+
+    @Query(value = "SELECT * FROM QUESTION_MASTER WHERE CATEGORY3_ID = ?1 ORDER BY rand() LIMIT 7", nativeQuery = true)
+    List<QuestionMaster> getQuestionMasterList7Randomly(long id);
+}
\ No newline at end of file
diff --git a/src/main/java/com/cazen/iti/service/TryQustionService.java b/src/main/java/com/cazen/iti/service/TryQustionService.java
index 3961ff3..69fbb2e 100644
--- a/src/main/java/com/cazen/iti/service/TryQustionService.java
+++ b/src/main/java/com/cazen/iti/service/TryQustionService.java
@@ -1,6 +1,7 @@
 package com.cazen.iti.service;

 import com.cazen.iti.domain.CommonCode;
+import com.cazen.iti.domain.QuestionMaster;

 import java.util.List;

@@ -16,5 +17,10 @@ public interface TryQustionService {
      */
     List<CommonCode> getCategory123CommonCodeList();

-
+    /**
+     *  Get the 7 random Question List
+     *
+     *  @return the list of QuestionMaster
+     */
+    List<QuestionMaster> getQuestionMasterList7Randomly(long id);
 }
diff --git a/src/main/java/com/cazen/iti/service/impl/TryQustionServiceImpl.java b/src/main/java/com/cazen/iti/service/impl/TryQustionServiceImpl.java
index b48c743..a2e265e 100644
--- a/src/main/java/com/cazen/iti/service/impl/TryQustionServiceImpl.java
+++ b/src/main/java/com/cazen/iti/service/impl/TryQustionServiceImpl.java
@@ -1,6 +1,7 @@
 package com.cazen.iti.service.impl;

 import com.cazen.iti.domain.CommonCode;
+import com.cazen.iti.domain.QuestionMaster;
 import com.cazen.iti.repository.TryQuestionRepository;
 import com.cazen.iti.service.TryQustionService;
 import org.slf4j.Logger;
@@ -21,7 +22,7 @@ public class TryQustionServiceImpl implements TryQustionService {
     private final Logger log = LoggerFactory.getLogger(TryQustionServiceImpl.class);

     @Inject
-    private TryQuestionRepository trtQuestionRepository;
+    private TryQuestionRepository tryQuestionRepository;

     /**
      *  Get the Category 123 CommonCode entity
@@ -31,7 +32,19 @@ public class TryQustionServiceImpl implements TryQustionService {
     @Transactional(readOnly = true)
     public List<CommonCode> getCategory123CommonCodeList() {
         log.debug("Request to get category123CommonCode : {}");
-        List<CommonCode> category123CommonCodeList = trtQuestionRepository.getCategory123CommonCodeList();
+        List<CommonCode> category123CommonCodeList = tryQuestionRepository.getCategory123CommonCodeList();
         return category123CommonCodeList;
     }
+
+    /**
+     *  Get the 7 random Question List
+     *
+     *  @return the list of QuestionMaster
+     */
+    @Transactional(readOnly = true)
+    public List<QuestionMaster> getQuestionMasterList7Randomly(long id) {
+        log.debug("Request to get getCategory123CommonCodeList : {}");
+        List<QuestionMaster> questionMasterList = tryQuestionRepository.getQuestionMasterList7Randomly(id);
+        return questionMasterList;
+    }
 }
diff --git a/src/main/java/com/cazen/iti/web/rest/TryQuestionResource.java b/src/main/java/com/cazen/iti/web/rest/TryQuestionResource.java
index 7591c6a..246fbae 100644
--- a/src/main/java/com/cazen/iti/web/rest/TryQuestionResource.java
+++ b/src/main/java/com/cazen/iti/web/rest/TryQuestionResource.java
@@ -1,6 +1,7 @@
 package com.cazen.iti.web.rest;

 import com.cazen.iti.domain.*;
+import com.cazen.iti.service.CommonCodeService;
 import com.cazen.iti.service.TryQustionService;
 import com.cazen.iti.service.util.AES256Util;
 import com.cazen.iti.web.rest.util.HeaderUtil;
@@ -36,6 +37,9 @@ public class TryQuestionResource {
     private TryQustionService tryQuestionService;

     @Inject
+    private CommonCodeService commonCodeService;
+
+    @Inject
     private AES256Util aes256Util;
     /**
      * GET  /tryQuestion : get all category 123 Code.
@@ -72,9 +76,10 @@ public class TryQuestionResource {
             return ResponseEntity.badRequest().headers(HeaderUtil.createFailureAlert("category3Selectbox", "notextists", "카테고리를 선택해 주세요")).body(null);
         }

+        List<QuestionMaster> questionMasterList = tryQuestionService.getQuestionMasterList7Randomly(commonCodeService.findByCd_Id(category3SelectboxVal).getId());
         //UpQuestionMaster result = uploadQuestionService.save(upQuestionMaster);

-        List<QuestionMaster> questionMasterList = getSampleQuestionMasterList();
+        //List<QuestionMaster> questionMasterList = getSampleQuestionMasterList();

         return new ResponseEntity<>(questionMasterList, HttpStatus.OK);
     }
--
2.5.0.windows.1

